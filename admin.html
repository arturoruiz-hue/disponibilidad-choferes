<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Disponibilidad de Choferes</title>
  <style>
    :root{--bg:#0b1020;--card:#121737;--accent:#7aa2ff;--text:#e8ecff;--sub:#b7c0ff}
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    body{margin:0;background:linear-gradient(180deg,#0b1020,#0f1540);color:var(--text)}
    header{padding:20px 16px;border-bottom:1px solid #1b2252;background:#0c1230;position:sticky;top:0;z-index:2}
    header h1{margin:0;font-size:20px;letter-spacing:.3px}
    header .sub{color:var(--sub);font-size:12px;margin-top:4px}
    .wrap{max-width:700px;margin:0 auto;padding:20px 16px 80px}
    .card{background:var(--card);border:1px solid #1b2252;border-radius:18px;box-shadow:0 10px 24px rgba(0,0,0,.25);margin-bottom:16px}
    .card .hd{padding:16px 18px;border-bottom:1px solid #1b2252;display:flex;align-items:center;justify-content:space-between}
    .card .hd h2{margin:0;font-size:16px}
    .card .bd{padding:16px 18px}
    label{font-size:12px;color:var(--sub);display:block;margin-bottom:6px}
    input[type="text"],select{width:100%;padding:12px;border-radius:12px;border:1px solid #2a3161;background:#0f1540;color:var(--text)}
    .btn{appearance:none;border:none;border-radius:12px;padding:12px 14px;background:var(--accent);color:#0b1020;font-weight:700;cursor:pointer;width:100%}
    .tag{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#1a1f4b;color:var(--sub);font-size:12px}
    .cal{user-select:none}
    .cal header{display:flex;align-items:center;justify-content:space-between;background:transparent;border:none;padding:0;margin:0 0 10px 0}
    .cal h3{margin:0;font-size:14px;color:var(--text)}
    .cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
    .dow{font-size:11px;color:var(--sub);text-align:center;margin-bottom:4px}
    .day{padding:10px;border-radius:10px;text-align:center;border:1px solid #27306a;background:#0e1437;cursor:pointer}
    .day.other{opacity:.35}
    .day.sel{outline:2px solid var(--accent);background:#1b2361}
    .day.today{border-color:var(--accent)}
    .pillbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pill{background:#1b2361;border:1px solid #27306a;border-radius:999px;padding:4px 8px;font-size:12px}
  </style>
</head>
<body>
  <header>
    <h1>Disponibilidad de Choferes</h1>
    <div class="sub">Captura semanal de disponibilidad</div>
  </header>

  <div class="wrap">
    <section class="card" id="formCard">
      <div class="hd"><h2>Capturar disponibilidad</h2></div>
      <div class="bd">
        <div>
          <label for="driverId">ID de chofer</label>
          <input id="driverId" type="text" placeholder="Ej. CH-001" />
        </div>
        <div style="margin-top:12px">
          <label for="driverName">Nombre del chofer</label>
          <input id="driverName" type="text" placeholder="Nombre completo" />
        </div>
        <div style="margin-top:12px">
          <label for="partner">Nombre del socio</label>
          <select id="partner"></select>
        </div>
        <div style="margin-top:16px">
          <label>Selecciona múltiples fechas disponibles</label>
          <div class="cal" id="calendar"></div>
          <div class="pillbar" id="chosen"></div>
        </div>
        <div style="margin-top:16px">
          <button class="btn" id="saveBtn">Guardar disponibilidad</button>
        </div>
      </div>
    </section>
  </div>

  <script>
  const partners = ["ALVIPACK SAS DE CV (AZCA)","ALEJANDRA VANESSA LEMUS PADILLA","SOCIO EJEMPLO"];
  const partnerSel = document.getElementById('partner');
  partners.forEach(p=>{ const o=document.createElement('option'); o.value=p; o.textContent=p; partnerSel.appendChild(o);});

  const fmtISO = d => new Date(d.getFullYear(), d.getMonth(), d.getDate()).toISOString().slice(0,10);
  const today = new Date();
  let calState = { ym: new Date(today.getFullYear(), today.getMonth(), 1), selected: new Set() };
  let lastClicked = null;

  function buildCalendar(){
    const host = document.getElementById('calendar'); host.innerHTML='';
    const head = document.createElement('div'); head.className='cal header';
    const h3 = document.createElement('h3'); h3.textContent = calState.ym.toLocaleDateString('es-MX',{month:'long',year:'numeric'});
    const prev = document.createElement('button'); prev.textContent='◀'; prev.onclick=()=>{calState.ym = new Date(calState.ym.getFullYear(), calState.ym.getMonth()-1, 1); buildCalendar();};
    const next = document.createElement('button'); next.textContent='▶'; next.onclick=()=>{calState.ym = new Date(calState.ym.getFullYear(), calState.ym.getMonth()+1, 1); buildCalendar();};
    head.append(prev,h3,next); host.appendChild(head);
    const dow = ['L','M','M','J','V','S','D'];
    const dowWrap = document.createElement('div'); dowWrap.className='cal-grid';
    dow.forEach(d=>{ const s=document.createElement('div'); s.className='dow'; s.textContent=d; dowWrap.appendChild(s); });
    host.appendChild(dowWrap);
    const grid = document.createElement('div'); grid.className='cal-grid';
    const firstDay = new Date(calState.ym.getFullYear(), calState.ym.getMonth(), 1);
    const start = new Date(firstDay); start.setDate(start.getDate() - ((start.getDay()+6)%7));
    for(let i=0;i<42;i++){
      const d = new Date(start); d.setDate(start.getDate()+i);
      const btn = document.createElement('div'); btn.className='day'; btn.textContent = d.getDate();
      if(d.getMonth() !== calState.ym.getMonth()) btn.classList.add('other');
      if(fmtISO(d) === fmtISO(today)) btn.classList.add('today');
      if(calState.selected.has(fmtISO(d))) btn.classList.add('sel');
      btn.onclick = (ev)=>{
        const iso = fmtISO(d);
        if(ev.shiftKey && lastClicked){
          const d1 = new Date(lastClicked), d2 = new Date(iso);
          const a = d1<d2? d1:d2, b = d1<d2? d2:d1;
          for(let cur=new Date(a); cur<=b; cur.setDate(cur.getDate()+1)){
            calState.selected.add(fmtISO(cur));
          }
        } else if(ev.metaKey || ev.ctrlKey){
          if(calState.selected.has(iso)) calState.selected.delete(iso); else calState.selected.add(iso);
          lastClicked = iso;
        } else {
          if(calState.selected.has(iso)) calState.selected.delete(iso); else calState.selected.add(iso);
          lastClicked = iso;
        }
        buildCalendar(); updateChosen();
      };
      grid.appendChild(btn);
    }
    host.appendChild(grid);
  }

  function updateChosen(){
    const bar = document.getElementById('chosen'); bar.innerHTML='';
    [...calState.selected].sort().forEach(iso=>{
      const p = document.createElement('span'); p.className='pill'; p.textContent = new Date(iso).toLocaleDateString('es-MX');
      bar.appendChild(p);
    })
  }

  function onSave(){
    const id = document.getElementById('driverId').value.trim();
    const name = document.getElementById('driverName').value.trim();
    const socio = document.getElementById('partner').value.trim();
    const dates = [...calState.selected].sort();
    if(!id || !name || !socio || dates.length===0){ alert('Completa todos los datos y selecciona fechas'); return; }
    alert(`Guardado para ${name}: ${dates.length} fecha(s)`);
    calState.selected.clear(); buildCalendar(); updateChosen();
    document.getElementById('driverId').value = '';
    document.getElementById('driverName').value = '';
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    buildCalendar(); updateChosen();
    document.getElementById('saveBtn').onclick = onSave;
  });
  </script>
</body>
</html>
